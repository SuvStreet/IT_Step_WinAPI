Обработка сообщений
===

Ресурсы
---

* содержат различные элементы: иконки, курсоры, шаблоны диалоговых окон, меню и др.
* файл описания ресурсов имеет расширение .rc
* нужна компиляция
* создается файл resource.h

```cpp
#include "resource.h"
wndclass.hIconSm = LoadIcon(hInst, MAKEINTRESOURCE(IDI_ICON1));
```

Изменение иконки (вариант 1)
---

* если ресурсов нет, то добавить новый ресурс (**`Resource Files / Add / Resource… / Icon / Import...`** и выбрать свою иконку)
* скомпилировать файл ресурсов
* узнать числовую константу (**`IDI`**) для иконки (`View Code...` и найти символьную константу для иконки – например, **`IDI_ICON1`**)
* подключить заголовочный файл **`"resource.h"`**

```cpp
#include "resource.h"
wndclass.hIconSm = LoadIcon(hInst, MAKEINTRESOURCE(IDI_ICON1));
```

Изменение иконки (вариант 2)
---

* если ресурсов нет, то добавить новый ресурс
(**`Resource Files / Add / Resource… / Icon / Import…`** и выбрать свою иконку)
* скомпилировать файл ресурсов
* узнать числовую константу (**`IDI`**) для иконки
(зайти в Resource View [Ctrl + LShift + E], в дереве правой кнопкой щелкнуть по нужной иконке `View Code...` и посмотреть `Resource Symbols...`)

```cpp
wndclass.hIconSm = LoadIcon(hInst, MAKEINTRESOURCE(101));
```

Сообщения мыши
---

* начинаются с префикса **`WM_`**

Cообщения               | Описание
------------------------|----------------------
**`WM_LBUTTONDOWN`**    |   нажата левая кнопка мыши
**`WM_RBUTTONDOWN`**    |   нажата правая кнопка мыши
**`WM_LBUTTONUP`**      |   отпущена левая кнопка мыши
**`WM_RBUTTONUP`**      |   отпущена правая кнопка мыши
**`WM_LBUTTONDBLCLK`**  |   двойной щелчок левой кнопкой мыши
**`WM_RBUTTONDBLCLK`**  |   двойной щелчок правой кнопкой мыши
**`WM_MOUSEMOVE`**      |   перемещение курсора мыши
**`WM_MOUSEWHEEL`**     |   прокрутка колесика

Особенности сообщений мыши
---

* обрабатываются в функции `WndProc()`
* в параметре `lParam` содержатся координаты курсора мыши
* чтобы извлечь координаты курсора мыши, нужны макросы `LOWORD` (x) и `HIWORD` (y)
* в параметре `wParam` содержится информация, какая кнопка мыши нажата
* для обработки двойных щелчков должен быть выставлен стиль класса окна `CS_DBLCLKS`

Обработка сообщений мыши (пример)
---

```cpp
int x, y;

switch(iMsg) {
  case WM_LBUTTONDOWN:
    x = LOWORD(lParam);
    y = HIWORD(lParam);
    MoveWindow(hwnd, x, y, 300, 300, true);
    break;
  case WM_DESTROY:
    PostQuitMessage(0);
    return 0;
}
```

Сообщения клавиатуры
---

* начинаются с префикса **`WM_`**


Cообщения             | Описание
----------------------|----------------------
**`WM_KEYDOWN`**      |   нажата любая клавиша без Alt
**`WM_KEYUP`**        |   отпущена нажатая несистемная клавиша
**`WM_SYSKEYDOWN`**   |   нажата любая клавиша в сочетании с Alt
**`WM_SYSKEYUP`**     |   отпущена системная клавиша

* обрабатываются в функции `WndProc`()
* в параметре wParam содержится виртуальный код нажатой / отпущенной клавиши

Виртуальные коды клавиш
---

Коды                                      | Описание
------------------------------------------|-------------------------
**`VK_SHIFT`**                            |   Shift
**`VK_CONTROL`**                          |   Control
**`VK_MENU`**                             |   Alt
**`VK_ESCAPE`**                           |   Esc
**`VK_F1 … VK_F12`**                      |   F1 … F12
**`VK_CAPITAL`**                          |   Caps Lock
**`VK_RETURN`**                           |   Enter
**`VK_SPACE`**                            |   Пробел
**`VK_LEFT, VK_RIGHT, VK_UP, VK_DOWN`**   |   Стрелки
**`х30 ... 0х39`**                        |   0 ... 9
**`0х41 ... 0х5a`**                       |   A ... Z















[**-->     Laboratory_work3     <--**](https://github.com/SuvStreet/IT_Step_WinAPI/tree/master/Laboratory_work/Work3)

**16.08.2017**
